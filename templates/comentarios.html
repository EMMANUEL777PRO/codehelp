{% load static %}

{% extends "base.html" %}

{% block title %}Comentarios | CodeHelp{% endblock %}

{% block content %}
<section>
    <h2>Comentarios de usuarios</h2>
    <form id="formulario-comentario">
        <label for="nombre">Nombre:</label>
        <input type="text" id="nombre" name="nombre" required>

        <label for="mensaje">Comentario:</label>
        <textarea id="mensaje" name="mensaje" rows="4" required></textarea>

        <button type="submit">Enviar</button>
    </form>

    <div id="lista-comentarios"></div>
</section>

<script>
document.addEventListener("DOMContentLoaded", function() {
    const formulario = document.getElementById("formulario-comentario");
    const listaComentarios = document.getElementById("lista-comentarios");

    function cargarComentarios() {
        let comentarios = JSON.parse(localStorage.getItem("comentarios")) || [];
        listaComentarios.innerHTML = "";
        comentarios.forEach(c => {
            let div = document.createElement("div");
            div.classList.add("comentario");
            div.innerHTML = `<strong>${c.nombre}</strong>: ${c.mensaje}`;
            listaComentarios.appendChild(div);
        });
    }

    formulario.addEventListener("submit", function(event) {
        event.preventDefault();
        let nombre = document.getElementById("nombre").value.trim();
        let mensaje = document.getElementById("mensaje").value.trim();
        if(!nombre || !mensaje) return;
        let comentarios = JSON.parse(localStorage.getItem("comentarios")) || [];
        comentarios.push({ nombre, mensaje });
        localStorage.setItem("comentarios", JSON.stringify(comentarios));
        formulario.reset();
        cargarComentarios();
    });

    cargarComentarios();
});
</script>
{% endblock %}
